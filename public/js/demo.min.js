$(document).ready(function(){"use strict";$(".example-menu").magicMenu({moreHtml:"Ещё...",name:"magicMenu1",callbackHide:"hello"}),$(".example-menu2").on("init",function(e,i){console.log("init",i)}).magicMenu({name:"magicMenu2",moreHtml:"Ещёёёёёёёё...",className:"magic-menu"}).on("afterHide",function(e,i,n){console.log("afterHide",$(i),$(n))}).on("afterShow",function(e,i,n){console.log("afterShow",$(i),$(n))})}),function(e){"use strict";var i={};i=function(){function i(i,n){console.time("initMenu");var t=this;t.$menu=e(i),t.options=t.setOptions(n),t.init(),t.match(),t.initEvents(),console.timeEnd("initMenu")}return i}(),i.prototype.setOptions=function(e){var i=this;return i.name=e.name||"default",i.moreHtml=e.moreHtml||"More...",i.className=e.className||"magic-menu",i},i.prototype.init=function(){console.time("init");var i=this,n=i.className;i.$item=i.$menu.children(),i.$link=i.$item.children("a"),i.$menu.addClass(n),i.$item.addClass(n+"__item"),i.$link.addClass(n+"__link"),i.isVisibleMore=!1,i.$moreMenu="",i.$moreItem=i.$item.eq(0).clone(),i.$moreItem.addClass(n+"__item_more").children("a").html(i.options.moreHtml).attr("href","#more"),i.$moreMenu=e('<ul class="'+n+'__more-menu">'),i.$moreMenu.append(i.$item.clone()).children().removeClass(n+"__item").addClass(n+"__item-more"),i.$moreItem.append(i.$moreMenu),i.$menu.append(i.$moreItem),i.$item=i.$item.not("."+n+"__item_more"),i.isVisibleMore=!1,console.timeEnd("init"),i.$menu.trigger("init",[this.$menu])},i.prototype.match=function(){console.time("Match");var e,i,n,t=this,o=t.$menu.outerWidth(),s=t.$moreMenu.children("li"),m=t.$item,r=t.$moreItem,l=m.length,a=0,c=l,u=r.outerWidth();for(n=0;n<=l;n++)if(e=m.eq(n),i=s.eq(n),a+=e.outerWidth(),e.is(":hidden")&&e.show(),i.is(":hidden")&&i.show(),a+u>o){c=n;break}c<l?(r.show(),t.isVisibleMore=!0):(t.isVisibleMore=!1,r.hide()),m.slice(c).hide(),s.slice(0,c).hide().end().slice(c).show(),console.timeEnd("Match")},i.prototype.initEvents=function(){var i=this,n=e(window);n.bind("resizeEnd",function(){console.log("resizeEnd"),i.match()}),n.on("resize",function(){this.resizeTO&&clearTimeout(this.resizeTO),this.resizeTO=setTimeout(function(){e(this).trigger("resizeEnd")},0)})},e.fn.magicMenu=function(e){var n,t=this,o=t.length;if(o)for(n=0;n<o;n++)t[n].menu=new i(t[n],e);else console.error("no elements");return t}}($);