$(document).ready(function(){$(".example-menu").magicMenu({moreHtml:"Ещё..."}),$(".example-menu2").magicMenu({name:"magicMenu"})}),$.fn.magicMenu=function(e){var n={},i={moreHtml:"More..."};e.moreHtml&&(i.moreHtml=e.moreHtml),n.init=function(e){n.$menu=$(e),n.$item=n.$menu.children(),n.$link=n.$item.children("a"),n.$menu.addClass("magic-menu"),n.$item.addClass("magic-menu__item"),n.$link.addClass("magic-menu__link"),n.$moreMenu="";var m=n.$item.last(),t=m.clone();t.addClass("magic-menu__item_more").children("a").html(i.moreHtml),m.after(t),t.append('<ul class="magic-menu__more-menu"></ul>'),n.$moreMenu=t.find(".magic-menu__more-menu"),n.$itemMore=n.$item.last().next(),n.$item=n.$item.not(".magic-menu__item_more"),n.$item.each(function(){var e=$(this).clone();e.removeClass("magic-menu__item").children("a"),n.$moreMenu.append(e)}),n.match()},n.match=function(){console.log(n.$menu),console.log("widthMenu:",n.$menu.width());var e=n.$menu.outerWidth(),i=n.$moreMenu.children("li"),m=n.$item,t=n.$itemMore,a=0,o=m.length-1,l=0;m.each(function(){a+=$(this).outerWidth(),$(this).data("width",$(this).outerWidth())}),a+=t.outerWidth(),console.log(a),console.log(e);for(var c=o;c>=0;c--)l+=m.eq(c).outerWidth(),console.log("width",a-l+m.eq(c).outerWidth()),a-l+m.eq(c).outerWidth()>=e?(m.eq(c).hide(),i.eq(c).show()):(m.eq(c).show(),i.eq(c).hide()),m.is(":hidden")?t.show():t.hide()},$(this).length?n.init(this):console.error("no elements"),$(window).on("resize",n.match)};