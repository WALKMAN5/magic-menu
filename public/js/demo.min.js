$(document).ready(function(){"use strict";$(".example-menu").magicMenu({moreHtml:"Ещё...",name:"magicMenu1",callbackHide:"hello"}),$(".example-menu2").on("init",function(e,n){console.log("init",n)}).magicMenu({name:"magicMenu2",moreHtml:"Ещёёёёёёёё...",className:"magic-menu"}).on("afterHide",function(e,n,t){console.log("afterHide",$(n),$(t))}).on("afterShow",function(e,n,t){console.log("afterShow",$(n),$(t))})}),function(e){"use strict";var n={};n=function(){function n(n,t){console.time("initMenu");var i=this;i.$menu=e(n),i.options=i.setOptions(t),i.init(),i.match(),i.initEvents(),console.timeEnd("initMenu")}return n}(),n.prototype.setOptions=function(e){var n=this;return n.name=e.name||"default",n.moreHtml=e.moreHtml||"More...",n.className=e.className||"magic-menu",n},n.prototype.init=function(){console.time("init");var n=this,t=n.className;n.$item=n.$menu.children(),n.$link=n.$item.children("a"),n.$menu.addClass(t),n.$item.addClass(t+"__item"),n.$link.addClass(t+"__link"),n.isVisibleMore=!1,n.$moreMenu="",n.$moreItem=n.$item.eq(0).clone(),n.$moreItem.addClass(t+"__item_more").children("a").html(n.options.moreHtml).attr("href","#more"),n.$moreMenu=e('<ul class="'+t+'__more-menu">'),n.$moreMenu.append(n.$item.clone()).children().removeClass(t+"__item").addClass(t+"__item-more"),n.$moreItem.append(n.$moreMenu),n.$menu.append(n.$moreItem),n.$item=n.$item.not("."+t+"__item_more"),console.timeEnd("init"),n.$menu.trigger("init",[this.$menu])},n.prototype.match=function(){console.time("Match");var e,n,t,i=this,o=i.$menu.outerWidth(),s=i.$moreMenu.children("li"),r=i.$item,m=i.$moreItem,a=r.length-1,l=0,c=a;for(console.time("for"),t=0;t<=a;t++)if(console.log(r.eq(t).outerWidth()),l+=r.eq(t).outerWidth(),e=r.eq(t),n=s.eq(t),e.is(":hidden")&&e.show(),n.is(":hidden")&&n.show(),l+m.outerWidth()>o){c=t;break}c<a?m.show():m.hide(),r.slice(c).hide(),s.slice(0,c).hide(),s.slice(c).show(),console.timeEnd("for"),console.timeEnd("Match")},n.prototype.initEvents=function(){var n=this,t=e(window);t.bind("resizeEnd",function(){console.log("resizeEnd"),n.match()}),t.on("resize",function(){this.resizeTO&&clearTimeout(this.resizeTO),this.resizeTO=setTimeout(function(){e(this).trigger("resizeEnd")},0)})},e.fn.magicMenu=function(e){var t,i=this,o=i.length;if(o)for(t=0;t<o;t++)i[t].menu=new n(i[t],e);else console.error("no elements");return i}}($);