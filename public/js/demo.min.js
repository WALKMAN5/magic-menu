$(document).ready(function(){"use strict";$(".example-menu").magicMenu({moreHtml:"Ещё...",name:"magicMenu1",callbackHide:"hello"}),$(".example-menu2").magicMenu({name:"magicMenu2",moreHtml:"Ещёёёёёёёё...",className:"magic-menu",callbackInit:function(e){console.log("init",e)},callbackHide:function(e,i){console.log("hidden",e,i)},callbackShow:function(e,i){console.log("show",e,i)}})}),function(e){"use strict";var i={};i=function(){function i(i,n){var t=this;t.$menu=e(i),t.options=t.setOptions(n),t.init(),t.match(),t.initEvents()}return i}(),i.prototype.setOptions=function(e){function i(e){return e&&"function"==typeof e?e:function(){}}var n=this;return n.name=e.name||"default",n.moreHtml=e.moreHtml||"More...",n.className=e.className||"magic-menu",n.callbackInit=i(e.callbackInit),n.callbackHide=i(e.callbackHide),n.callbackShow=i(e.callbackShow),n},i.prototype.init=function(){var i=this,n=i.className;i.$item=i.$menu.children(),i.$link=i.$item.children("a"),i.$menu.addClass(n),i.$item.addClass(n+"__item"),i.$link.addClass(n+"__link"),i.isVisibleMore=!1,i.$moreMenu="";var t=i.$item.last(),o=t.clone();o.addClass(n+"__item_more").children("a").html(i.options.moreHtml),t.after(o),o.append('<ul class="'+n+'__more-menu"></ul>'),i.$moreMenu=o.find("."+n+"__more-menu"),i.$itemMore=i.$item.last().next(),i.$item=i.$item.not("."+n+"__item_more"),i.$item.each(function(){var t=e(this).clone();t.removeClass(n+"__item").addClass(n+"__item_more").children("a"),i.$moreMenu.append(t)}),i.callbackInit(i.$menu)},i.prototype.match=function(){var i,n=this,t=n.$menu.outerWidth(),o=n.$moreMenu.children("li"),a=n.$item,m=n.$itemMore,l=0,s=a.length-1,r=0;for(a.each(function(){l+=e(this).outerWidth()}),(!n.isVisibleMore&&l>t||n.isVisibleMore)&&(l+=m.outerWidth()),i=s;i>=0;i--)r+=a.eq(i).outerWidth(),l-r+a.eq(i).outerWidth()>=t?a.eq(i).is(":visible")&&(a.eq(i).hide(),o.eq(i).show(),n.isVisibleMore=!0,console.log(n.$menu),console.log("visibleMore",n.isVisibleMore),n.callbackHide(a.eq(i),o.eq(i))):a.eq(i).is(":hidden")&&(a.eq(i).show(),o.eq(i).hide(),n.callbackShow(a.eq(i),o.eq(i))),a.is(":hidden")?m.show():(m.hide(),n.isVisibleMore=!1)},i.prototype.initEvents=function(){var i=this,n=e(window);n.on("resize",function(){i.match()})},e.fn.magicMenu=function(e){var n,t=this,o=t.length;if(o)for(n=0;n<o;n++)t[n].menu=new i(t[n],e);else console.error("no elements");return t}}($);